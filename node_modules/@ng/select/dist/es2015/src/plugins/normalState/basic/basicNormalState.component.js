/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ChangeDetectionStrategy, ChangeDetectorRef, Inject, Optional, ElementRef, EventEmitter } from '@angular/core';
import { extend } from '@asseco/common';
import { NG_SELECT_PLUGIN_INSTANCES } from '../../../components/select/types';
import { NORMAL_STATE_OPTIONS } from '../types';
import { TEXTS_LOCATOR } from '../../textsLocator/types';
import { VALUE_HANDLER } from '../../valueHandler/types';
/**
 * Default options for normal state
 * \@internal
 * @type {?}
 */
const defaultOptions = {
    cssClasses: {
        normalStateElement: 'btn btn-select',
        selectedCarret: 'selected-caret fa fa-caret-down',
        selectedValue: 'selected-value'
    },
    texts: {
        nothingSelected: 'Nothing selected'
    },
    readonly: false
};
/**
 * Component used for rendering basic simple normal state of select
 */
export class BasicNormalStateComponent {
    //######################### constructor #########################
    /**
     * @param {?} ngSelectPlugins
     * @param {?} pluginElement
     * @param {?} _changeDetector
     * @param {?=} options
     */
    constructor(ngSelectPlugins, pluginElement, _changeDetector, options) {
        this.ngSelectPlugins = ngSelectPlugins;
        this.pluginElement = pluginElement;
        this._changeDetector = _changeDetector;
        /**
         * Occurs when user clicks on normal state
         */
        this.click = new EventEmitter();
        /**
         * Occurs when normal state gains focus
         */
        this.focus = new EventEmitter();
        /**
         * Occurs when user tries to cancel one of selected values
         */
        this.cancelOption = new EventEmitter();
        //######################### public properties - template bindings #########################
        /**
         * Object containing available texts
         * \@internal
         */
        this.texts = {};
        this._options = extend(true, {}, defaultOptions, options);
    }
    //######################### public properties - implementation of BasicNormalState #########################
    /**
     * Options for NgSelect plugin
     * @return {?}
     */
    get options() {
        return this._options;
    }
    /**
     * @param {?} options
     * @return {?}
     */
    set options(options) {
        this._options = extend(true, this._options, options);
    }
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     * @return {?}
     */
    ngOnDestroy() {
        if (this._textsChangedSubscription) {
            this._textsChangedSubscription.unsubscribe();
            this._textsChangedSubscription = null;
        }
    }
    //######################### public methods - implementation of BasicNormalState #########################
    /**
     * Initialize plugin, to be ready to use, initialize communication with other plugins
     * @return {?}
     */
    initialize() {
        /** @type {?} */
        let textsLocator = (/** @type {?} */ (this.ngSelectPlugins[TEXTS_LOCATOR]));
        if (this._textsLocator && this._textsLocator != textsLocator) {
            this._textsChangedSubscription.unsubscribe();
            this._textsChangedSubscription = null;
            this._textsLocator = null;
        }
        if (!this._textsLocator) {
            this._textsLocator = textsLocator;
            this._textsChangedSubscription = this._textsLocator.textsChange.subscribe((/**
             * @return {?}
             */
            () => this._initTexts()));
        }
        /** @type {?} */
        let valueHandler = (/** @type {?} */ (this.ngSelectPlugins[VALUE_HANDLER]));
        if (this.valueHandler && this.valueHandler != valueHandler) {
            this.valueHandler = null;
        }
        if (!this.valueHandler) {
            this.valueHandler = valueHandler;
        }
        this._initTexts();
    }
    /**
     * Initialize plugin options, all operations required to be done with plugin options are handled here
     * @return {?}
     */
    initOptions() {
    }
    /**
     * Explicitly runs invalidation of content (change detection)
     * @return {?}
     */
    invalidateVisuals() {
        this._changeDetector.detectChanges();
    }
    //######################### protected methods #########################
    /**
     * Initialize texts
     * @protected
     * @return {?}
     */
    _initTexts() {
        Object.keys(this.options.texts).forEach((/**
         * @param {?} key
         * @return {?}
         */
        key => {
            this.texts[key] = this._textsLocator.getText(this.options.texts[key]);
        }));
        this._changeDetector.detectChanges();
    }
}
BasicNormalStateComponent.decorators = [
    { type: Component, args: [{
                selector: "div.normal-state",
                template: "<ng-template #defaultLook>{{valueHandler?.selectedOptions | ngSelectValue: texts?.nothingSelected}}</ng-template>\r\n\r\n<button [ngClass]=\"options?.cssClasses?.normalStateElement\" (click)=\"click.emit()\" (focus)=\"focus?.emit()\" [disabled]=\"!!options?.readonly\" type=\"button\" [title]=\"valueHandler?.selectedOptions | ngSelectValue: texts?.nothingSelected\">\r\n    <span [ngClass]=\"options?.cssClasses?.selectedValue\"><ng-container *ngTemplateOutlet=\"templateGatherer?.normalStateTemplate || defaultLook; context: {$implicit: this}\"></ng-container></span>\r\n    <span [ngClass]=\"options?.cssClasses?.selectedCarret\"></span>\r\n</button>",
                changeDetection: ChangeDetectionStrategy.OnPush,
                styles: [`button.btn-select
         {
             display: flex;
             width: 100%;
             padding: 5px 0px 4px 6px;
             background-color: #ffffff;
             background-image: none;
             border: 1px solid #cccccc;
             border-radius: 4px;
             box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset;
             height: 28px;
             overflow: hidden;
         }

         button.btn-select:hover
         {
             background-color: #F2F2F2;
         }

         button.btn-select:active
         {
             box-shadow: 0 0 5px -1px #888888 inset;
         }
       
         button.btn-select .selected-value
         {
             flex: 1;
             text-align: left;
             min-width: 0;
         }
       
         button.btn-select .selected-caret
         {
             flex: 0 0 20px;
             align-self: center;
         }`]
            }] }
];
/** @nocollapse */
BasicNormalStateComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [NG_SELECT_PLUGIN_INSTANCES,] }, { type: Optional }] },
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: undefined, decorators: [{ type: Inject, args: [NORMAL_STATE_OPTIONS,] }, { type: Optional }] }
];
if (false) {
    /**
     * Texts locator used for handling texts
     * @type {?}
     * @protected
     */
    BasicNormalStateComponent.prototype._textsLocator;
    /**
     * Subscription for changes in texts
     * @type {?}
     * @protected
     */
    BasicNormalStateComponent.prototype._textsChangedSubscription;
    /**
     * Options for NgSelect plugin
     * @type {?}
     * @protected
     */
    BasicNormalStateComponent.prototype._options;
    /**
     * Occurs when user clicks on normal state
     * @type {?}
     */
    BasicNormalStateComponent.prototype.click;
    /**
     * Occurs when normal state gains focus
     * @type {?}
     */
    BasicNormalStateComponent.prototype.focus;
    /**
     * Occurs when user tries to cancel one of selected values
     * @type {?}
     */
    BasicNormalStateComponent.prototype.cancelOption;
    /**
     * Gatherer used for obtaining custom templates
     * @type {?}
     */
    BasicNormalStateComponent.prototype.templateGatherer;
    /**
     * Object containing available texts
     * \@internal
     * @type {?}
     */
    BasicNormalStateComponent.prototype.texts;
    /**
     * Value handler used in NgSelect
     * \@internal
     * @type {?}
     */
    BasicNormalStateComponent.prototype.valueHandler;
    /** @type {?} */
    BasicNormalStateComponent.prototype.ngSelectPlugins;
    /** @type {?} */
    BasicNormalStateComponent.prototype.pluginElement;
    /**
     * @type {?}
     * @protected
     */
    BasicNormalStateComponent.prototype._changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWNOb3JtYWxTdGF0ZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9ub3JtYWxTdGF0ZS9iYXNpYy9iYXNpY05vcm1hbFN0YXRlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSx1QkFBdUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQVksTUFBTSxlQUFlLENBQUM7QUFDM0ksT0FBTyxFQUFDLE1BQU0sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBTXRDLE9BQU8sRUFBQywwQkFBMEIsRUFBQyxNQUFNLGtDQUFrQyxDQUFDO0FBRTVFLE9BQU8sRUFBQyxvQkFBb0IsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUU5QyxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sMEJBQTBCLENBQUM7QUFFdkQsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7TUFPakQsY0FBYyxHQUNwQjtJQUNJLFVBQVUsRUFDVjtRQUNJLGtCQUFrQixFQUFFLGdCQUFnQjtRQUNwQyxjQUFjLEVBQUUsaUNBQWlDO1FBQ2pELGFBQWEsRUFBRSxnQkFBZ0I7S0FDbEM7SUFDRCxLQUFLLEVBQ0w7UUFDSSxlQUFlLEVBQUUsa0JBQWtCO0tBQ3RDO0lBQ0QsUUFBUSxFQUFFLEtBQUs7Q0FDbEI7Ozs7QUFrREQsTUFBTSxPQUFPLHlCQUF5Qjs7Ozs7Ozs7SUFvRWxDLFlBQW1FLGVBQXdDLEVBQ3hGLGFBQXlCLEVBQ3RCLGVBQWtDLEVBQ0YsT0FBaUM7UUFIcEIsb0JBQWUsR0FBZixlQUFlLENBQXlCO1FBQ3hGLGtCQUFhLEdBQWIsYUFBYSxDQUFZO1FBQ3RCLG9CQUFlLEdBQWYsZUFBZSxDQUFtQjs7OztRQWxDakQsVUFBSyxHQUF1QixJQUFJLFlBQVksRUFBUSxDQUFDOzs7O1FBS3JELFVBQUssR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQzs7OztRQUtyRCxpQkFBWSxHQUFzQyxJQUFJLFlBQVksRUFBdUIsQ0FBQzs7Ozs7O1FBYTFGLFVBQUssR0FBcUIsRUFBRSxDQUFDO1FBY2hDLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLElBQUksRUFBRSxFQUFFLEVBQUUsY0FBYyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQzlELENBQUM7Ozs7OztJQWxERCxJQUFXLE9BQU87UUFFZCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDekIsQ0FBQzs7Ozs7SUFDRCxJQUFXLE9BQU8sQ0FBQyxPQUFnQztRQUUvQyxJQUFJLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN6RCxDQUFDOzs7Ozs7SUFrRE0sV0FBVztRQUVkLElBQUcsSUFBSSxDQUFDLHlCQUF5QixFQUNqQztZQUNJLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM3QyxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDO1NBQ3pDO0lBQ0wsQ0FBQzs7Ozs7O0lBT00sVUFBVTs7WUFFVCxZQUFZLEdBQUcsbUJBQUEsSUFBSSxDQUFDLGVBQWUsQ0FBQyxhQUFhLENBQUMsRUFBZ0I7UUFFdEUsSUFBRyxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxhQUFhLElBQUksWUFBWSxFQUMzRDtZQUNJLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUM3QyxJQUFJLENBQUMseUJBQXlCLEdBQUcsSUFBSSxDQUFDO1lBRXRDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO1NBQzdCO1FBRUQsSUFBRyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQ3RCO1lBQ0ksSUFBSSxDQUFDLGFBQWEsR0FBRyxZQUFZLENBQUM7WUFFbEMsSUFBSSxDQUFDLHlCQUF5QixHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLFNBQVM7OztZQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBQyxDQUFDO1NBQ3RHOztZQUVHLFlBQVksR0FBRyxtQkFBQSxJQUFJLENBQUMsZUFBZSxDQUFDLGFBQWEsQ0FBQyxFQUFxQjtRQUUzRSxJQUFHLElBQUksQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLFlBQVksSUFBSSxZQUFZLEVBQ3pEO1lBQ0ksSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7U0FDNUI7UUFFRCxJQUFHLENBQUMsSUFBSSxDQUFDLFlBQVksRUFDckI7WUFDSSxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztTQUNwQztRQUVELElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztJQUN0QixDQUFDOzs7OztJQUtNLFdBQVc7SUFFbEIsQ0FBQzs7Ozs7SUFLTSxpQkFBaUI7UUFFcEIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QyxDQUFDOzs7Ozs7O0lBT1MsVUFBVTtRQUVoQixNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTzs7OztRQUFDLEdBQUcsQ0FBQyxFQUFFO1lBRTFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUMxRSxDQUFDLEVBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxlQUFlLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDekMsQ0FBQzs7O1lBMU1KLFNBQVMsU0FDVjtnQkFDSSxRQUFRLEVBQUUsa0JBQWtCO2dCQUM1Qix5cEJBQThDO2dCQUM5QyxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTt5QkFHM0M7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O1dBbUNHO2FBRVY7Ozs7NENBcUVnQixNQUFNLFNBQUMsMEJBQTBCLGNBQUcsUUFBUTtZQXZKb0IsVUFBVTtZQUEvQyxpQkFBaUI7NENBMEo1QyxNQUFNLFNBQUMsb0JBQW9CLGNBQUcsUUFBUTs7Ozs7Ozs7SUFoRW5ELGtEQUFzQzs7Ozs7O0lBS3RDLDhEQUFrRDs7Ozs7O0lBS2xELDZDQUE0Qzs7Ozs7SUFtQjVDLDBDQUE0RDs7Ozs7SUFLNUQsMENBQTREOzs7OztJQUs1RCxpREFBaUc7Ozs7O0lBS2pHLHFEQUEwQzs7Ozs7O0lBUTFDLDBDQUFvQzs7Ozs7O0lBTXBDLGlEQUF1Qzs7SUFHM0Isb0RBQStGOztJQUMvRixrREFBZ0M7Ozs7O0lBQ2hDLG9EQUE0QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEluamVjdCwgT3B0aW9uYWwsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95fSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtleHRlbmR9IGZyb20gJ0Bhc3NlY28vY29tbW9uJztcclxuaW1wb3J0IHtTdWJzY3JpcHRpb259IGZyb20gJ3J4anMnO1xyXG5cclxuaW1wb3J0IHtCYXNpY05vcm1hbFN0YXRlT3B0aW9ucywgQmFzaWNOb3JtYWxTdGF0ZX0gZnJvbSAnLi9iYXNpY05vcm1hbFN0YXRlLmludGVyZmFjZSc7XHJcbmltcG9ydCB7TmdTZWxlY3RQbHVnaW5HZW5lcmljLCBUZW1wbGF0ZUdhdGhlcmVyfSBmcm9tICcuLi8uLi8uLi9taXNjJztcclxuaW1wb3J0IHtOZ1NlbGVjdFBsdWdpbkluc3RhbmNlc30gZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9zZWxlY3QnO1xyXG5pbXBvcnQge05HX1NFTEVDVF9QTFVHSU5fSU5TVEFOQ0VTfSBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL3NlbGVjdC90eXBlcyc7XHJcbmltcG9ydCB7Tm9ybWFsU3RhdGVUZXh0c30gZnJvbSAnLi4vbm9ybWFsU3RhdGUuaW50ZXJmYWNlJztcclxuaW1wb3J0IHtOT1JNQUxfU1RBVEVfT1BUSU9OU30gZnJvbSAnLi4vdHlwZXMnO1xyXG5pbXBvcnQge1RleHRzTG9jYXRvcn0gZnJvbSAnLi4vLi4vdGV4dHNMb2NhdG9yJztcclxuaW1wb3J0IHtURVhUU19MT0NBVE9SfSBmcm9tICcuLi8uLi90ZXh0c0xvY2F0b3IvdHlwZXMnO1xyXG5pbXBvcnQge1ZhbHVlSGFuZGxlcn0gZnJvbSAnLi4vLi4vdmFsdWVIYW5kbGVyJztcclxuaW1wb3J0IHtWQUxVRV9IQU5ETEVSfSBmcm9tICcuLi8uLi92YWx1ZUhhbmRsZXIvdHlwZXMnO1xyXG5pbXBvcnQge05nU2VsZWN0T3B0aW9ufSBmcm9tICcuLi8uLi8uLi9jb21wb25lbnRzL29wdGlvbic7XHJcblxyXG4vKipcclxuICogRGVmYXVsdCBvcHRpb25zIGZvciBub3JtYWwgc3RhdGVcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5jb25zdCBkZWZhdWx0T3B0aW9uczogQmFzaWNOb3JtYWxTdGF0ZU9wdGlvbnMgPVxyXG57XHJcbiAgICBjc3NDbGFzc2VzOlxyXG4gICAge1xyXG4gICAgICAgIG5vcm1hbFN0YXRlRWxlbWVudDogJ2J0biBidG4tc2VsZWN0JyxcclxuICAgICAgICBzZWxlY3RlZENhcnJldDogJ3NlbGVjdGVkLWNhcmV0IGZhIGZhLWNhcmV0LWRvd24nLFxyXG4gICAgICAgIHNlbGVjdGVkVmFsdWU6ICdzZWxlY3RlZC12YWx1ZSdcclxuICAgIH0sXHJcbiAgICB0ZXh0czpcclxuICAgIHtcclxuICAgICAgICBub3RoaW5nU2VsZWN0ZWQ6ICdOb3RoaW5nIHNlbGVjdGVkJ1xyXG4gICAgfSxcclxuICAgIHJlYWRvbmx5OiBmYWxzZVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIENvbXBvbmVudCB1c2VkIGZvciByZW5kZXJpbmcgYmFzaWMgc2ltcGxlIG5vcm1hbCBzdGF0ZSBvZiBzZWxlY3RcclxuICovXHJcbkBDb21wb25lbnQoXHJcbntcclxuICAgIHNlbGVjdG9yOiBcImRpdi5ub3JtYWwtc3RhdGVcIixcclxuICAgIHRlbXBsYXRlVXJsOiAnYmFzaWNOb3JtYWxTdGF0ZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICAgIHN0eWxlczpcclxuICAgIFtcclxuICAgICAgICBgYnV0dG9uLmJ0bi1zZWxlY3RcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgICAgICAgcGFkZGluZzogNXB4IDBweCA0cHggNnB4O1xyXG4gICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcclxuICAgICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IG5vbmU7XHJcbiAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjY2NjO1xyXG4gICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNzUpIGluc2V0O1xyXG4gICAgICAgICAgICAgaGVpZ2h0OiAyOHB4O1xyXG4gICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgYnV0dG9uLmJ0bi1zZWxlY3Q6aG92ZXJcclxuICAgICAgICAge1xyXG4gICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0YyRjJGMjtcclxuICAgICAgICAgfVxyXG5cclxuICAgICAgICAgYnV0dG9uLmJ0bi1zZWxlY3Q6YWN0aXZlXHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCA1cHggLTFweCAjODg4ODg4IGluc2V0O1xyXG4gICAgICAgICB9XHJcbiAgICAgICBcclxuICAgICAgICAgYnV0dG9uLmJ0bi1zZWxlY3QgLnNlbGVjdGVkLXZhbHVlXHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgIGZsZXg6IDE7XHJcbiAgICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0O1xyXG4gICAgICAgICAgICAgbWluLXdpZHRoOiAwO1xyXG4gICAgICAgICB9XHJcbiAgICAgICBcclxuICAgICAgICAgYnV0dG9uLmJ0bi1zZWxlY3QgLnNlbGVjdGVkLWNhcmV0XHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAgIGZsZXg6IDAgMCAyMHB4O1xyXG4gICAgICAgICAgICAgYWxpZ24tc2VsZjogY2VudGVyO1xyXG4gICAgICAgICB9YFxyXG4gICAgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQmFzaWNOb3JtYWxTdGF0ZUNvbXBvbmVudCBpbXBsZW1lbnRzIEJhc2ljTm9ybWFsU3RhdGUsIE5nU2VsZWN0UGx1Z2luR2VuZXJpYzxCYXNpY05vcm1hbFN0YXRlT3B0aW9ucz4sIE9uRGVzdHJveVxyXG57XHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHJvdGVjdGVkIGZpZWxkcyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUZXh0cyBsb2NhdG9yIHVzZWQgZm9yIGhhbmRsaW5nIHRleHRzXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBfdGV4dHNMb2NhdG9yOiBUZXh0c0xvY2F0b3I7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpcHRpb24gZm9yIGNoYW5nZXMgaW4gdGV4dHNcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF90ZXh0c0NoYW5nZWRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9wdGlvbnMgZm9yIE5nU2VsZWN0IHBsdWdpblxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgX29wdGlvbnM6IEJhc2ljTm9ybWFsU3RhdGVPcHRpb25zO1xyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgcHJvcGVydGllcyAtIGltcGxlbWVudGF0aW9uIG9mIEJhc2ljTm9ybWFsU3RhdGUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3B0aW9ucyBmb3IgTmdTZWxlY3QgcGx1Z2luXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgb3B0aW9ucygpOiBCYXNpY05vcm1hbFN0YXRlT3B0aW9uc1xyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xyXG4gICAgfVxyXG4gICAgcHVibGljIHNldCBvcHRpb25zKG9wdGlvbnM6IEJhc2ljTm9ybWFsU3RhdGVPcHRpb25zKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBleHRlbmQodHJ1ZSwgdGhpcy5fb3B0aW9ucywgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPY2N1cnMgd2hlbiB1c2VyIGNsaWNrcyBvbiBub3JtYWwgc3RhdGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNsaWNrOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPY2N1cnMgd2hlbiBub3JtYWwgc3RhdGUgZ2FpbnMgZm9jdXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGZvY3VzOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPY2N1cnMgd2hlbiB1c2VyIHRyaWVzIHRvIGNhbmNlbCBvbmUgb2Ygc2VsZWN0ZWQgdmFsdWVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjYW5jZWxPcHRpb246IEV2ZW50RW1pdHRlcjxOZ1NlbGVjdE9wdGlvbjxhbnk+PiA9IG5ldyBFdmVudEVtaXR0ZXI8TmdTZWxlY3RPcHRpb248YW55Pj4oKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEdhdGhlcmVyIHVzZWQgZm9yIG9idGFpbmluZyBjdXN0b20gdGVtcGxhdGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0ZW1wbGF0ZUdhdGhlcmVyOiBUZW1wbGF0ZUdhdGhlcmVyO1xyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgcHJvcGVydGllcyAtIHRlbXBsYXRlIGJpbmRpbmdzICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9iamVjdCBjb250YWluaW5nIGF2YWlsYWJsZSB0ZXh0c1xyXG4gICAgICogQGludGVybmFsXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0ZXh0czogTm9ybWFsU3RhdGVUZXh0cyA9IHt9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVmFsdWUgaGFuZGxlciB1c2VkIGluIE5nU2VsZWN0XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgcHVibGljIHZhbHVlSGFuZGxlcjogVmFsdWVIYW5kbGVyPGFueT47XHJcblxyXG4gICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIGNvbnN0cnVjdG9yICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuICAgIGNvbnN0cnVjdG9yKEBJbmplY3QoTkdfU0VMRUNUX1BMVUdJTl9JTlNUQU5DRVMpIEBPcHRpb25hbCgpIHB1YmxpYyBuZ1NlbGVjdFBsdWdpbnM6IE5nU2VsZWN0UGx1Z2luSW5zdGFuY2VzLFxyXG4gICAgICAgICAgICAgICAgcHVibGljIHBsdWdpbkVsZW1lbnQ6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgICAgICAgICBwcm90ZWN0ZWQgX2NoYW5nZURldGVjdG9yOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICAgICAgICAgIEBJbmplY3QoTk9STUFMX1NUQVRFX09QVElPTlMpIEBPcHRpb25hbCgpIG9wdGlvbnM/OiBCYXNpY05vcm1hbFN0YXRlT3B0aW9ucylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gZXh0ZW5kKHRydWUsIHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIHB1YmxpYyBtZXRob2RzIC0gaW1wbGVtZW50YXRpb24gb2YgT25EZXN0cm95ICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxsZWQgd2hlbiBjb21wb25lbnQgaXMgZGVzdHJveWVkXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBuZ09uRGVzdHJveSgpXHJcbiAgICB7XHJcbiAgICAgICAgaWYodGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3RleHRzQ2hhbmdlZFN1YnNjcmlwdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgbWV0aG9kcyAtIGltcGxlbWVudGF0aW9uIG9mIEJhc2ljTm9ybWFsU3RhdGUgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBwbHVnaW4sIHRvIGJlIHJlYWR5IHRvIHVzZSwgaW5pdGlhbGl6ZSBjb21tdW5pY2F0aW9uIHdpdGggb3RoZXIgcGx1Z2luc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaW5pdGlhbGl6ZSgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHRleHRzTG9jYXRvciA9IHRoaXMubmdTZWxlY3RQbHVnaW5zW1RFWFRTX0xPQ0FUT1JdIGFzIFRleHRzTG9jYXRvcjtcclxuXHJcbiAgICAgICAgaWYodGhpcy5fdGV4dHNMb2NhdG9yICYmIHRoaXMuX3RleHRzTG9jYXRvciAhPSB0ZXh0c0xvY2F0b3IpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl90ZXh0c0NoYW5nZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3RleHRzTG9jYXRvciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighdGhpcy5fdGV4dHNMb2NhdG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNMb2NhdG9yID0gdGV4dHNMb2NhdG9yO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uID0gdGhpcy5fdGV4dHNMb2NhdG9yLnRleHRzQ2hhbmdlLnN1YnNjcmliZSgoKSA9PiB0aGlzLl9pbml0VGV4dHMoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgdmFsdWVIYW5kbGVyID0gdGhpcy5uZ1NlbGVjdFBsdWdpbnNbVkFMVUVfSEFORExFUl0gYXMgVmFsdWVIYW5kbGVyPGFueT47XHJcblxyXG4gICAgICAgIGlmKHRoaXMudmFsdWVIYW5kbGVyICYmIHRoaXMudmFsdWVIYW5kbGVyICE9IHZhbHVlSGFuZGxlcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLnZhbHVlSGFuZGxlcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsdWVIYW5kbGVyID0gdmFsdWVIYW5kbGVyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5faW5pdFRleHRzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplIHBsdWdpbiBvcHRpb25zLCBhbGwgb3BlcmF0aW9ucyByZXF1aXJlZCB0byBiZSBkb25lIHdpdGggcGx1Z2luIG9wdGlvbnMgYXJlIGhhbmRsZWQgaGVyZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaW5pdE9wdGlvbnMoKVxyXG4gICAge1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXhwbGljaXRseSBydW5zIGludmFsaWRhdGlvbiBvZiBjb250ZW50IChjaGFuZ2UgZGV0ZWN0aW9uKVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaW52YWxpZGF0ZVZpc3VhbHMoKTogdm9pZFxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2NoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHJvdGVjdGVkIG1ldGhvZHMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSB0ZXh0c1xyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgX2luaXRUZXh0cygpXHJcbiAgICB7XHJcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5vcHRpb25zLnRleHRzKS5mb3JFYWNoKGtleSA9PlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy50ZXh0c1trZXldID0gdGhpcy5fdGV4dHNMb2NhdG9yLmdldFRleHQodGhpcy5vcHRpb25zLnRleHRzW2tleV0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgICB9XHJcbn0iXX0=