/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ChangeDetectionStrategy, ChangeDetectorRef, Inject, Optional, ElementRef, ViewChild, EventEmitter } from '@angular/core';
import { extend } from '@asseco/common';
import { NG_SELECT_PLUGIN_INSTANCES } from '../../../components/select/types';
import { LIVE_SEARCH_OPTIONS } from '../types';
import { TEXTS_LOCATOR } from '../../textsLocator/types';
import { POPUP } from '../../popup/types';
/**
 * Default options for live search
 * \@internal
 * @type {?}
 */
var defaultOptions = {
    cssClasses: {
        wrapperDiv: 'wrapper-div',
        input: 'form-control'
    },
    texts: {
        inputPlaceholder: 'Filter options'
    },
    keepSearchValue: false
};
/**
 * Component used for obtaining basic live search html element
 */
var BasicLiveSearchComponent = /** @class */ (function () {
    //######################### constructor #########################
    function BasicLiveSearchComponent(ngSelectPlugins, pluginElement, _changeDetector, options) {
        this.ngSelectPlugins = ngSelectPlugins;
        this.pluginElement = pluginElement;
        this._changeDetector = _changeDetector;
        /**
         * Current value of live search
         */
        this.searchValue = null;
        /**
         * Occurs when current value of live search changes
         */
        this.searchValueChange = new EventEmitter();
        //######################### public properties - template bindings #########################
        /**
         * Object containing available texts
         * \@internal
         */
        this.texts = {};
        this._options = extend(true, {}, defaultOptions, options);
    }
    Object.defineProperty(BasicLiveSearchComponent.prototype, "options", {
        //######################### public properties - implementation of BasicLiveSearch #########################
        /**
         * Options for NgSelect plugin
         */
        get: 
        //######################### public properties - implementation of BasicLiveSearch #########################
        /**
         * Options for NgSelect plugin
         * @return {?}
         */
        function () {
            return this._options;
        },
        set: /**
         * @param {?} options
         * @return {?}
         */
        function (options) {
            this._options = extend(true, this._options, options);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BasicLiveSearchComponent.prototype, "liveSearchElement", {
        /**
         * HTML element that represents live search
         */
        get: /**
         * HTML element that represents live search
         * @return {?}
         */
        function () {
            return this.liveSearchElementChild.nativeElement;
        },
        enumerable: true,
        configurable: true
    });
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     */
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     * @return {?}
     */
    BasicLiveSearchComponent.prototype.ngOnDestroy = 
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     * @return {?}
     */
    function () {
        if (this._visibilityChangeSubscription) {
            this._visibilityChangeSubscription.unsubscribe();
            this._visibilityChangeSubscription = null;
        }
        if (this._textsChangedSubscription) {
            this._textsChangedSubscription.unsubscribe();
            this._textsChangedSubscription = null;
        }
    };
    //######################### public methods - implementation of BasicLiveSearch #########################
    /**
     * Initialize plugin, to be ready to use, initialize communication with other plugins
     */
    //######################### public methods - implementation of BasicLiveSearch #########################
    /**
     * Initialize plugin, to be ready to use, initialize communication with other plugins
     * @return {?}
     */
    BasicLiveSearchComponent.prototype.initialize = 
    //######################### public methods - implementation of BasicLiveSearch #########################
    /**
     * Initialize plugin, to be ready to use, initialize communication with other plugins
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var textsLocator = (/** @type {?} */ (this.ngSelectPlugins[TEXTS_LOCATOR]));
        if (this._textsLocator && this._textsLocator != textsLocator) {
            this._textsChangedSubscription.unsubscribe();
            this._textsChangedSubscription = null;
            this._textsLocator = null;
        }
        if (!this._textsLocator) {
            this._textsLocator = textsLocator;
            this._textsChangedSubscription = this._textsLocator.textsChange.subscribe((/**
             * @return {?}
             */
            function () { return _this._initTexts(); }));
        }
        /** @type {?} */
        var popup = (/** @type {?} */ (this.ngSelectPlugins[POPUP]));
        if (this._popup && this._popup != popup) {
            this._visibilityChangeSubscription.unsubscribe();
            this._visibilityChangeSubscription = null;
            this._popup = null;
        }
        if (!this._popup) {
            this._popup = popup;
            this._visibilityChangeSubscription = this._popup.visibilityChange.subscribe((/**
             * @return {?}
             */
            function () {
                if (!_this.options.keepSearchValue) {
                    _this.searchValue = '';
                    _this.searchValueChange.emit();
                    _this._changeDetector.detectChanges();
                }
            }));
        }
        this._initTexts();
    };
    /**
     * Initialize plugin options, all operations required to be done with plugin options are handled here
     */
    /**
     * Initialize plugin options, all operations required to be done with plugin options are handled here
     * @return {?}
     */
    BasicLiveSearchComponent.prototype.initOptions = /**
     * Initialize plugin options, all operations required to be done with plugin options are handled here
     * @return {?}
     */
    function () {
    };
    /**
     * Explicitly runs invalidation of content (change detection)
     */
    /**
     * Explicitly runs invalidation of content (change detection)
     * @return {?}
     */
    BasicLiveSearchComponent.prototype.invalidateVisuals = /**
     * Explicitly runs invalidation of content (change detection)
     * @return {?}
     */
    function () {
        this._changeDetector.detectChanges();
    };
    //######################### public methods - template bindings #########################
    /**
     * Handle input value
     * @param value Value of input
     * @internal
     */
    //######################### public methods - template bindings #########################
    /**
     * Handle input value
     * \@internal
     * @param {?} value Value of input
     * @return {?}
     */
    BasicLiveSearchComponent.prototype.handleInput = 
    //######################### public methods - template bindings #########################
    /**
     * Handle input value
     * \@internal
     * @param {?} value Value of input
     * @return {?}
     */
    function (value) {
        this.searchValue = value;
        this.searchValueChange.emit();
    };
    //######################### protected methods #########################
    /**
     * Initialize texts
     */
    //######################### protected methods #########################
    /**
     * Initialize texts
     * @protected
     * @return {?}
     */
    BasicLiveSearchComponent.prototype._initTexts = 
    //######################### protected methods #########################
    /**
     * Initialize texts
     * @protected
     * @return {?}
     */
    function () {
        var _this = this;
        Object.keys(this.options.texts).forEach((/**
         * @param {?} key
         * @return {?}
         */
        function (key) {
            _this.texts[key] = _this._textsLocator.getText(_this.options.texts[key]);
        }));
        this._changeDetector.detectChanges();
    };
    BasicLiveSearchComponent.decorators = [
        { type: Component, args: [{
                    selector: "ng-basic-live-search",
                    template: "<div style=\"display: none;\">\r\n    <div #liveSearchElement [ngClass]=\"options?.cssClasses?.wrapperDiv\">\r\n        <input [ngClass]=\"options?.cssClasses?.input\" type=\"text\" (input)=\"handleInput($event.target.value)\" [value]=\"searchValue\" placeholder=\"{{texts?.inputPlaceholder}}\">\r\n    </div>\r\n</div>",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    styles: [".wrapper-div\n        {\n            padding: 4px;\n            border-bottom: 1px solid #666;\n            margin-bottom: 2px;\n        }\n        \n        .form-control\n        {\n            width: 100%;\n        }"]
                }] }
    ];
    /** @nocollapse */
    BasicLiveSearchComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [NG_SELECT_PLUGIN_INSTANCES,] }, { type: Optional }] },
        { type: ElementRef },
        { type: ChangeDetectorRef },
        { type: undefined, decorators: [{ type: Inject, args: [LIVE_SEARCH_OPTIONS,] }, { type: Optional }] }
    ]; };
    BasicLiveSearchComponent.propDecorators = {
        liveSearchElementChild: [{ type: ViewChild, args: ['liveSearchElement',] }]
    };
    return BasicLiveSearchComponent;
}());
export { BasicLiveSearchComponent };
if (false) {
    /**
     * Texts locator used for handling texts
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._textsLocator;
    /**
     * Popup used in NgSelect
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._popup;
    /**
     * Subscription for changes in texts
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._textsChangedSubscription;
    /**
     * Subscription for changes of popup visibility
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._visibilityChangeSubscription;
    /**
     * Options for NgSelect plugin
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._options;
    /**
     * Current value of live search
     * @type {?}
     */
    BasicLiveSearchComponent.prototype.searchValue;
    /**
     * Occurs when current value of live search changes
     * @type {?}
     */
    BasicLiveSearchComponent.prototype.searchValueChange;
    /**
     * Object containing available texts
     * \@internal
     * @type {?}
     */
    BasicLiveSearchComponent.prototype.texts;
    /**
     * View child that represents live search element
     * \@internal
     * @type {?}
     */
    BasicLiveSearchComponent.prototype.liveSearchElementChild;
    /** @type {?} */
    BasicLiveSearchComponent.prototype.ngSelectPlugins;
    /** @type {?} */
    BasicLiveSearchComponent.prototype.pluginElement;
    /**
     * @type {?}
     * @protected
     */
    BasicLiveSearchComponent.prototype._changeDetector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWNMaXZlU2VhcmNoLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9wbHVnaW5zL2xpdmVTZWFyY2gvYmFzaWMvYmFzaWNMaXZlU2VhcmNoLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSx1QkFBdUIsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFZLE1BQU0sZUFBZSxDQUFDO0FBQ3RKLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQU10QyxPQUFPLEVBQUMsMEJBQTBCLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUU1RSxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFN0MsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBRXZELE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQzs7Ozs7O0lBTWxDLGNBQWMsR0FDcEI7SUFDSSxVQUFVLEVBQ1Y7UUFDSSxVQUFVLEVBQUUsYUFBYTtRQUN6QixLQUFLLEVBQUUsY0FBYztLQUN4QjtJQUNELEtBQUssRUFDTDtRQUNJLGdCQUFnQixFQUFFLGdCQUFnQjtLQUNyQztJQUNELGVBQWUsRUFBRSxLQUFLO0NBQ3pCOzs7O0FBS0Q7SUFrR0ksaUVBQWlFO0lBQ2pFLGtDQUFtRSxlQUF3QyxFQUN4RixhQUF5QixFQUN0QixlQUFrQyxFQUNILE9BQWdDO1FBSGxCLG9CQUFlLEdBQWYsZUFBZSxDQUF5QjtRQUN4RixrQkFBYSxHQUFiLGFBQWEsQ0FBWTtRQUN0QixvQkFBZSxHQUFmLGVBQWUsQ0FBbUI7Ozs7UUEzQmpELGdCQUFXLEdBQVcsSUFBSSxDQUFDOzs7O1FBSzNCLHNCQUFpQixHQUF1QixJQUFJLFlBQVksRUFBUSxDQUFD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QUFHLFFBQVE7Ozt5Q0FQakQsU0FBUyxTQUFDLG1CQUFtQjs7SUE4SGxDLCtCQUFDO0NBQUEsQUE3TkQsSUE2TkM7U0F6TVksd0JBQXdCOzs7Ozs7O0lBT2pDLGlEQUFzQzs7Ozs7O0lBS3RDLDBDQUF3Qjs7Ozs7O0lBS3hCLDZEQUFrRDs7Ozs7O0lBS2xELGlFQUFzRDs7Ozs7O0lBS3RELDRDQUEyQzs7Ozs7SUEyQjNDLCtDQUFrQzs7Ozs7SUFLbEMscURBQXdFOzs7Ozs7SUFReEUseUNBQW1DOzs7Ozs7SUFRbkMsMERBQ3VEOztJQUczQyxtREFBK0Y7O0lBQy9GLGlEQUFnQzs7Ozs7SUFDaEMsbURBQTRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDaGFuZ2VEZXRlY3RvclJlZiwgSW5qZWN0LCBPcHRpb25hbCwgRWxlbWVudFJlZiwgVmlld0NoaWxkLCBFdmVudEVtaXR0ZXIsIE9uRGVzdHJveX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7ZXh0ZW5kfSBmcm9tICdAYXNzZWNvL2NvbW1vbic7XHJcbmltcG9ydCB7U3Vic2NyaXB0aW9ufSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7QmFzaWNMaXZlU2VhcmNoT3B0aW9ucywgQmFzaWNMaXZlU2VhcmNofSBmcm9tICcuL2Jhc2ljTGl2ZVNlYXJjaC5pbnRlcmZhY2UnO1xyXG5pbXBvcnQge05nU2VsZWN0UGx1Z2luR2VuZXJpY30gZnJvbSAnLi4vLi4vLi4vbWlzYyc7XHJcbmltcG9ydCB7TmdTZWxlY3RQbHVnaW5JbnN0YW5jZXN9IGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvc2VsZWN0JztcclxuaW1wb3J0IHtOR19TRUxFQ1RfUExVR0lOX0lOU1RBTkNFU30gZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9zZWxlY3QvdHlwZXMnO1xyXG5pbXBvcnQge0xpdmVTZWFyY2hUZXh0c30gZnJvbSAnLi4vbGl2ZVNlYXJjaC5pbnRlcmZhY2UnO1xyXG5pbXBvcnQge0xJVkVfU0VBUkNIX09QVElPTlN9IGZyb20gJy4uL3R5cGVzJztcclxuaW1wb3J0IHtUZXh0c0xvY2F0b3J9IGZyb20gJy4uLy4uL3RleHRzTG9jYXRvcic7XHJcbmltcG9ydCB7VEVYVFNfTE9DQVRPUn0gZnJvbSAnLi4vLi4vdGV4dHNMb2NhdG9yL3R5cGVzJztcclxuaW1wb3J0IHtQb3B1cH0gZnJvbSAnLi4vLi4vcG9wdXAnO1xyXG5pbXBvcnQge1BPUFVQfSBmcm9tICcuLi8uLi9wb3B1cC90eXBlcyc7XHJcblxyXG4vKipcclxuICogRGVmYXVsdCBvcHRpb25zIGZvciBsaXZlIHNlYXJjaFxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmNvbnN0IGRlZmF1bHRPcHRpb25zOiBCYXNpY0xpdmVTZWFyY2hPcHRpb25zID1cclxue1xyXG4gICAgY3NzQ2xhc3NlczpcclxuICAgIHtcclxuICAgICAgICB3cmFwcGVyRGl2OiAnd3JhcHBlci1kaXYnLFxyXG4gICAgICAgIGlucHV0OiAnZm9ybS1jb250cm9sJ1xyXG4gICAgfSxcclxuICAgIHRleHRzOlxyXG4gICAge1xyXG4gICAgICAgIGlucHV0UGxhY2Vob2xkZXI6ICdGaWx0ZXIgb3B0aW9ucydcclxuICAgIH0sXHJcbiAgICBrZWVwU2VhcmNoVmFsdWU6IGZhbHNlXHJcbn07XHJcblxyXG4vKipcclxuICogQ29tcG9uZW50IHVzZWQgZm9yIG9idGFpbmluZyBiYXNpYyBsaXZlIHNlYXJjaCBodG1sIGVsZW1lbnRcclxuICovXHJcbkBDb21wb25lbnQoXHJcbntcclxuICAgIHNlbGVjdG9yOiBcIm5nLWJhc2ljLWxpdmUtc2VhcmNoXCIsXHJcbiAgICB0ZW1wbGF0ZVVybDogJ2Jhc2ljTGl2ZVNlYXJjaC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICAgIHN0eWxlczpcclxuICAgIFtcclxuICAgICAgICBgLndyYXBwZXItZGl2XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBwYWRkaW5nOiA0cHg7XHJcbiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNjY2O1xyXG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAycHg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC5mb3JtLWNvbnRyb2xcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xyXG4gICAgICAgIH1gXHJcbiAgICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBCYXNpY0xpdmVTZWFyY2hDb21wb25lbnQgaW1wbGVtZW50cyBCYXNpY0xpdmVTZWFyY2gsIE5nU2VsZWN0UGx1Z2luR2VuZXJpYzxCYXNpY0xpdmVTZWFyY2hPcHRpb25zPiwgT25EZXN0cm95XHJcbntcclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwcm90ZWN0ZWQgZmllbGRzICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRleHRzIGxvY2F0b3IgdXNlZCBmb3IgaGFuZGxpbmcgdGV4dHNcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF90ZXh0c0xvY2F0b3I6IFRleHRzTG9jYXRvcjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFBvcHVwIHVzZWQgaW4gTmdTZWxlY3RcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF9wb3B1cDogUG9wdXA7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpcHRpb24gZm9yIGNoYW5nZXMgaW4gdGV4dHNcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF90ZXh0c0NoYW5nZWRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFN1YnNjcmlwdGlvbiBmb3IgY2hhbmdlcyBvZiBwb3B1cCB2aXNpYmlsaXR5XHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBfdmlzaWJpbGl0eUNoYW5nZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3B0aW9ucyBmb3IgTmdTZWxlY3QgcGx1Z2luXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBfb3B0aW9uczogQmFzaWNMaXZlU2VhcmNoT3B0aW9ucztcclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIHByb3BlcnRpZXMgLSBpbXBsZW1lbnRhdGlvbiBvZiBCYXNpY0xpdmVTZWFyY2ggIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3B0aW9ucyBmb3IgTmdTZWxlY3QgcGx1Z2luXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgb3B0aW9ucygpOiBCYXNpY0xpdmVTZWFyY2hPcHRpb25zXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX29wdGlvbnM7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgc2V0IG9wdGlvbnMob3B0aW9uczogQmFzaWNMaXZlU2VhcmNoT3B0aW9ucylcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9vcHRpb25zID0gZXh0ZW5kKHRydWUsIHRoaXMuX29wdGlvbnMsIG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSFRNTCBlbGVtZW50IHRoYXQgcmVwcmVzZW50cyBsaXZlIHNlYXJjaFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0IGxpdmVTZWFyY2hFbGVtZW50KCk6IEhUTUxFbGVtZW50XHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGl2ZVNlYXJjaEVsZW1lbnRDaGlsZC5uYXRpdmVFbGVtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3VycmVudCB2YWx1ZSBvZiBsaXZlIHNlYXJjaFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2VhcmNoVmFsdWU6IHN0cmluZyA9IG51bGw7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBPY2N1cnMgd2hlbiBjdXJyZW50IHZhbHVlIG9mIGxpdmUgc2VhcmNoIGNoYW5nZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNlYXJjaFZhbHVlQ2hhbmdlOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XHJcblxyXG4gICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIHB1YmxpYyBwcm9wZXJ0aWVzIC0gdGVtcGxhdGUgYmluZGluZ3MgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT2JqZWN0IGNvbnRhaW5pbmcgYXZhaWxhYmxlIHRleHRzXHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRleHRzOiBMaXZlU2VhcmNoVGV4dHMgPSB7fTtcclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIHByb3BlcnRpZXMgLSBjaGlsZHJlbiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBWaWV3IGNoaWxkIHRoYXQgcmVwcmVzZW50cyBsaXZlIHNlYXJjaCBlbGVtZW50XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgQFZpZXdDaGlsZCgnbGl2ZVNlYXJjaEVsZW1lbnQnKVxyXG4gICAgcHVibGljIGxpdmVTZWFyY2hFbGVtZW50Q2hpbGQ6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+O1xyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBjb25zdHJ1Y3RvciAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcbiAgICBjb25zdHJ1Y3RvcihASW5qZWN0KE5HX1NFTEVDVF9QTFVHSU5fSU5TVEFOQ0VTKSBAT3B0aW9uYWwoKSBwdWJsaWMgbmdTZWxlY3RQbHVnaW5zOiBOZ1NlbGVjdFBsdWdpbkluc3RhbmNlcyxcclxuICAgICAgICAgICAgICAgIHB1YmxpYyBwbHVnaW5FbGVtZW50OiBFbGVtZW50UmVmLFxyXG4gICAgICAgICAgICAgICAgcHJvdGVjdGVkIF9jaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgICAgICAgICBASW5qZWN0KExJVkVfU0VBUkNIX09QVElPTlMpIEBPcHRpb25hbCgpIG9wdGlvbnM/OiBCYXNpY0xpdmVTZWFyY2hPcHRpb25zKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBleHRlbmQodHJ1ZSwge30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIG1ldGhvZHMgLSBpbXBsZW1lbnRhdGlvbiBvZiBPbkRlc3Ryb3kgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIGNvbXBvbmVudCBpcyBkZXN0cm95ZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIG5nT25EZXN0cm95KClcclxuICAgIHtcclxuICAgICAgICBpZih0aGlzLl92aXNpYmlsaXR5Q2hhbmdlU3Vic2NyaXB0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fdmlzaWJpbGl0eUNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl92aXNpYmlsaXR5Q2hhbmdlU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX3RleHRzQ2hhbmdlZFN1YnNjcmlwdGlvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RleHRzQ2hhbmdlZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl90ZXh0c0NoYW5nZWRTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIG1ldGhvZHMgLSBpbXBsZW1lbnRhdGlvbiBvZiBCYXNpY0xpdmVTZWFyY2ggIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBwbHVnaW4sIHRvIGJlIHJlYWR5IHRvIHVzZSwgaW5pdGlhbGl6ZSBjb21tdW5pY2F0aW9uIHdpdGggb3RoZXIgcGx1Z2luc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgaW5pdGlhbGl6ZSgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHRleHRzTG9jYXRvciA9IHRoaXMubmdTZWxlY3RQbHVnaW5zW1RFWFRTX0xPQ0FUT1JdIGFzIFRleHRzTG9jYXRvcjtcclxuXHJcbiAgICAgICAgaWYodGhpcy5fdGV4dHNMb2NhdG9yICYmIHRoaXMuX3RleHRzTG9jYXRvciAhPSB0ZXh0c0xvY2F0b3IpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl90ZXh0c0NoYW5nZWRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3RleHRzTG9jYXRvciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighdGhpcy5fdGV4dHNMb2NhdG9yKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNMb2NhdG9yID0gdGV4dHNMb2NhdG9yO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fdGV4dHNDaGFuZ2VkU3Vic2NyaXB0aW9uID0gdGhpcy5fdGV4dHNMb2NhdG9yLnRleHRzQ2hhbmdlLnN1YnNjcmliZSgoKSA9PiB0aGlzLl9pbml0VGV4dHMoKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgcG9wdXAgPSB0aGlzLm5nU2VsZWN0UGx1Z2luc1tQT1BVUF0gYXMgUG9wdXA7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX3BvcHVwICYmIHRoaXMuX3BvcHVwICE9IHBvcHVwKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fdmlzaWJpbGl0eUNoYW5nZVN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xyXG4gICAgICAgICAgICB0aGlzLl92aXNpYmlsaXR5Q2hhbmdlU3Vic2NyaXB0aW9uID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKCF0aGlzLl9wb3B1cClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvcHVwID0gcG9wdXA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl92aXNpYmlsaXR5Q2hhbmdlU3Vic2NyaXB0aW9uID0gdGhpcy5fcG9wdXAudmlzaWJpbGl0eUNoYW5nZS5zdWJzY3JpYmUoKCkgPT5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYoIXRoaXMub3B0aW9ucy5rZWVwU2VhcmNoVmFsdWUpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hWYWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoVmFsdWVDaGFuZ2UuZW1pdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9pbml0VGV4dHMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemUgcGx1Z2luIG9wdGlvbnMsIGFsbCBvcGVyYXRpb25zIHJlcXVpcmVkIHRvIGJlIGRvbmUgd2l0aCBwbHVnaW4gb3B0aW9ucyBhcmUgaGFuZGxlZCBoZXJlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpbml0T3B0aW9ucygpXHJcbiAgICB7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHBsaWNpdGx5IHJ1bnMgaW52YWxpZGF0aW9uIG9mIGNvbnRlbnQgKGNoYW5nZSBkZXRlY3Rpb24pXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpbnZhbGlkYXRlVmlzdWFscygpOiB2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgbWV0aG9kcyAtIHRlbXBsYXRlIGJpbmRpbmdzICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZSBpbnB1dCB2YWx1ZVxyXG4gICAgICogQHBhcmFtIHZhbHVlIFZhbHVlIG9mIGlucHV0XHJcbiAgICAgKiBAaW50ZXJuYWxcclxuICAgICAqL1xyXG4gICAgcHVibGljIGhhbmRsZUlucHV0KHZhbHVlOiBzdHJpbmcpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hWYWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoVmFsdWVDaGFuZ2UuZW1pdCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwcm90ZWN0ZWQgbWV0aG9kcyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJbml0aWFsaXplIHRleHRzXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBfaW5pdFRleHRzKClcclxuICAgIHtcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLm9wdGlvbnMudGV4dHMpLmZvckVhY2goa2V5ID0+XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnRleHRzW2tleV0gPSB0aGlzLl90ZXh0c0xvY2F0b3IuZ2V0VGV4dCh0aGlzLm9wdGlvbnMudGV4dHNba2V5XSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2NoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcclxuICAgIH1cclxufSJdfQ==