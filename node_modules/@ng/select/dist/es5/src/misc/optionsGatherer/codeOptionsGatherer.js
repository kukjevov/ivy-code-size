/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter } from "@angular/core";
import { isBlank } from "@asseco/common";
import { LIVE_SEARCH } from "../../plugins/liveSearch/types";
/**
 * Options gatherer used for static options gathering from code
 * @template TValue
 */
var /**
 * Options gatherer used for static options gathering from code
 * @template TValue
 */
CodeOptionsGatherer = /** @class */ (function () {
    //######################### constructor #########################
    function CodeOptionsGatherer(_liveSearchFilter) {
        this._liveSearchFilter = _liveSearchFilter;
        //######################### private fields #########################
        /**
         * Array of visible, displayed options for select
         */
        this._availableOptions = [];
        /**
         * Array of provided options for select
         */
        this._options = [];
        /**
         * Occurs when array of visible, displayed options has changed
         */
        this._availableOptionsChange = new EventEmitter();
        /**
         * Occurs when array of provided options has changed
         */
        this.optionsChange = new EventEmitter();
        if (isBlank(this._liveSearchFilter)) {
            this._liveSearchFilter = (/**
             * @param {?} query
             * @return {?}
             */
            function (query) {
                return (/**
                 * @param {?} itm
                 * @return {?}
                 */
                function (itm) { return itm.text.indexOf(query) >= 0; });
            });
        }
    }
    Object.defineProperty(CodeOptionsGatherer.prototype, "options", {
        get: /**
         * @return {?}
         */
        function () {
            return this._options;
        },
        //######################### public properties - implementation of OptionsGatherer #########################
        /**
         * Array of provided options for select
         */
        set: 
        //######################### public properties - implementation of OptionsGatherer #########################
        /**
         * Array of provided options for select
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._options = value;
            this._availableOptions = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CodeOptionsGatherer.prototype, "availableOptions", {
        /**
         * Array of visible, displayed options for select
         */
        get: /**
         * Array of visible, displayed options for select
         * @return {?}
         */
        function () {
            return this._availableOptions;
        },
        enumerable: true,
        configurable: true
    });
    ;
    Object.defineProperty(CodeOptionsGatherer.prototype, "availableOptionsChange", {
        /**
         * Occurs when array of visible, displayed options has changed
         */
        get: /**
         * Occurs when array of visible, displayed options has changed
         * @return {?}
         */
        function () {
            return this._availableOptionsChange;
        },
        enumerable: true,
        configurable: true
    });
    //######################### public methods - implmentation of OptionsGatherer #########################
    /**
     * Initialize gatherer during initialization phase
     */
    //######################### public methods - implmentation of OptionsGatherer #########################
    /**
     * Initialize gatherer during initialization phase
     * @return {?}
     */
    CodeOptionsGatherer.prototype.initializeGatherer = 
    //######################### public methods - implmentation of OptionsGatherer #########################
    /**
     * Initialize gatherer during initialization phase
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var liveSearch = (/** @type {?} */ (this.ngSelectPlugins[LIVE_SEARCH]));
        if (this._liveSearch && this._liveSearch != liveSearch) {
            this._searchValueChangeSubscription.unsubscribe();
            this._searchValueChangeSubscription = null;
            this._liveSearch = null;
        }
        if (!this._liveSearch) {
            this._liveSearch = liveSearch;
            this._searchValueChangeSubscription = this._liveSearch.searchValueChange.subscribe((/**
             * @return {?}
             */
            function () {
                if (!_this._liveSearch.searchValue) {
                    _this._availableOptions = _this.options;
                    _this._availableOptionsChange.emit();
                    return;
                }
                _this._availableOptions = _this.options.filter(_this._liveSearchFilter(_this._liveSearch.searchValue));
                _this._availableOptionsChange.emit();
            }));
        }
    };
    /**
     * Called when gatherer needs to be destroyed
     */
    /**
     * Called when gatherer needs to be destroyed
     * @return {?}
     */
    CodeOptionsGatherer.prototype.destroyGatherer = /**
     * Called when gatherer needs to be destroyed
     * @return {?}
     */
    function () {
        if (this._searchValueChangeSubscription) {
            this._searchValueChangeSubscription.unsubscribe();
            this._searchValueChangeSubscription = null;
        }
    };
    return CodeOptionsGatherer;
}());
/**
 * Options gatherer used for static options gathering from code
 * @template TValue
 */
export { CodeOptionsGatherer };
if (false) {
    /**
     * Array of visible, displayed options for select
     * @type {?}
     * @private
     */
    CodeOptionsGatherer.prototype._availableOptions;
    /**
     * Array of provided options for select
     * @type {?}
     * @private
     */
    CodeOptionsGatherer.prototype._options;
    /**
     * Occurs when array of visible, displayed options has changed
     * @type {?}
     * @private
     */
    CodeOptionsGatherer.prototype._availableOptionsChange;
    /**
     * Live search plugin currently used in NgSelect
     * @type {?}
     * @protected
     */
    CodeOptionsGatherer.prototype._liveSearch;
    /**
     * Subscription for changes of live search value
     * @type {?}
     * @protected
     */
    CodeOptionsGatherer.prototype._searchValueChangeSubscription;
    /**
     * Occurs when array of provided options has changed
     * @type {?}
     */
    CodeOptionsGatherer.prototype.optionsChange;
    /**
     * NgSelect plugin instances available for gatherer
     * @type {?}
     */
    CodeOptionsGatherer.prototype.ngSelectPlugins;
    /**
     * @type {?}
     * @private
     */
    CodeOptionsGatherer.prototype._liveSearchFilter;
    /* Skipping unhandled member: ;*/
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29kZU9wdGlvbnNHYXRoZXJlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9taXNjL29wdGlvbnNHYXRoZXJlci9jb2RlT3B0aW9uc0dhdGhlcmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQU92QyxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sZ0NBQWdDLENBQUM7Ozs7O0FBSzNEOzs7OztJQXNFSSxpRUFBaUU7SUFDakUsNkJBQW9CLGlCQUE0QztRQUE1QyxzQkFBaUIsR0FBakIsaUJBQWlCLENBQTJCOzs7OztRQWhFeEQsc0JBQWlCLEdBQTZCLEVBQUUsQ0FBQzs7OztRQUtqRCxhQUFRLEdBQTZCLEVBQUUsQ0FBQzs7OztRQUt4Qyw0QkFBdUIsR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQzs7OztRQThCeEUsa0JBQWEsR0FBdUIsSUFBSSxZQUFZLEVBQVEsQ0FBQztRQTBCaEUsSUFBRyxPQUFPLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEVBQ2xDO1lBQ0ksSUFBSSxDQUFDLGlCQUFpQjs7OztZQUFHLFVBQUMsS0FBYTtnQkFFbkM7Ozs7Z0JBQU8sVUFBQSxHQUFHLElBQUksT0FBQSxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQTVCLENBQTRCLEVBQUM7WUFDL0MsQ0FBQyxDQUFBLENBQUM7U0FDTDtJQUNMLENBQUM7SUE5Q0Qsc0JBQVcsd0NBQU87Ozs7UUFLbEI7WUFFSSxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7UUFDekIsQ0FBQztRQWJELDJHQUEyRztRQUUzRzs7V0FFRzs7Ozs7Ozs7UUFDSCxVQUFtQixLQUErQjtZQUU5QyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztZQUN0QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSyxDQUFDO1FBQ25DLENBQUM7OztPQUFBO0lBY0Qsc0JBQVcsaURBQWdCO1FBSDNCOztXQUVHOzs7OztRQUNIO1lBRUksT0FBTyxJQUFJLENBQUMsaUJBQWlCLENBQUM7UUFDbEMsQ0FBQzs7O09BQUE7SUFBQSxDQUFDO0lBS0Ysc0JBQVcsdURBQXNCO1FBSGpDOztXQUVHOzs7OztRQUNIO1lBRUksT0FBTyxJQUFJLENBQUMsdUJBQXVCLENBQUM7UUFDeEMsQ0FBQzs7O09BQUE7SUFtQkQsdUdBQXVHO0lBRXZHOztPQUVHOzs7Ozs7SUFDSSxnREFBa0I7Ozs7OztJQUF6QjtRQUFBLGlCQThCQzs7WUE1Qk8sVUFBVSxHQUFHLG1CQUFBLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxDQUFDLEVBQWM7UUFFaEUsSUFBRyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLElBQUksVUFBVSxFQUNyRDtZQUNJLElBQUksQ0FBQyw4QkFBOEIsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNsRCxJQUFJLENBQUMsOEJBQThCLEdBQUcsSUFBSSxDQUFDO1lBRTNDLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO1NBQzNCO1FBRUQsSUFBRyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQ3BCO1lBQ0ksSUFBSSxDQUFDLFdBQVcsR0FBRyxVQUFVLENBQUM7WUFFOUIsSUFBSSxDQUFDLDhCQUE4QixHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsaUJBQWlCLENBQUMsU0FBUzs7O1lBQUM7Z0JBRS9FLElBQUcsQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFDaEM7b0JBQ0ksS0FBSSxDQUFDLGlCQUFpQixHQUFHLEtBQUksQ0FBQyxPQUFPLENBQUM7b0JBQ3RDLEtBQUksQ0FBQyx1QkFBdUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQkFFcEMsT0FBTztpQkFDVjtnQkFFRCxLQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztnQkFDbkcsS0FBSSxDQUFDLHVCQUF1QixDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3hDLENBQUMsRUFBQyxDQUFDO1NBQ047SUFDTCxDQUFDO0lBRUQ7O09BRUc7Ozs7O0lBQ0ksNkNBQWU7Ozs7SUFBdEI7UUFFSSxJQUFHLElBQUksQ0FBQyw4QkFBOEIsRUFDdEM7WUFDSSxJQUFJLENBQUMsOEJBQThCLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDbEQsSUFBSSxDQUFDLDhCQUE4QixHQUFHLElBQUksQ0FBQztTQUM5QztJQUNMLENBQUM7SUFDTCwwQkFBQztBQUFELENBQUMsQUFsSUQsSUFrSUM7Ozs7Ozs7Ozs7OztJQTNIRyxnREFBeUQ7Ozs7OztJQUt6RCx1Q0FBZ0Q7Ozs7OztJQUtoRCxzREFBK0U7Ozs7OztJQUsvRSwwQ0FBa0M7Ozs7OztJQUtsQyw2REFBdUQ7Ozs7O0lBb0J2RCw0Q0FBb0U7Ozs7O0lBcUJwRSw4Q0FBZ0Q7Ozs7O0lBR3BDLGdEQUFvRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RXZlbnRFbWl0dGVyfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge2lzQmxhbmt9IGZyb20gXCJAYXNzZWNvL2NvbW1vblwiO1xyXG5pbXBvcnQge1N1YnNjcmlwdGlvbn0gZnJvbSBcInJ4anNcIjtcclxuXHJcbmltcG9ydCB7T3B0aW9uc0dhdGhlcmVyLCBMaXZlU2VhcmNoRmlsdGVyfSBmcm9tIFwiLi9vcHRpb25zR2F0aGVyZXIuaW50ZXJmYWNlXCI7XHJcbmltcG9ydCB7TmdTZWxlY3RPcHRpb259IGZyb20gXCIuLi8uLi9jb21wb25lbnRzL29wdGlvblwiO1xyXG5pbXBvcnQge05nU2VsZWN0UGx1Z2luSW5zdGFuY2VzfSBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9zZWxlY3RcIjtcclxuaW1wb3J0IHtMaXZlU2VhcmNofSBmcm9tIFwiLi4vLi4vcGx1Z2lucy9saXZlU2VhcmNoXCI7XHJcbmltcG9ydCB7TElWRV9TRUFSQ0h9IGZyb20gXCIuLi8uLi9wbHVnaW5zL2xpdmVTZWFyY2gvdHlwZXNcIjtcclxuXHJcbi8qKlxyXG4gKiBPcHRpb25zIGdhdGhlcmVyIHVzZWQgZm9yIHN0YXRpYyBvcHRpb25zIGdhdGhlcmluZyBmcm9tIGNvZGVcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDb2RlT3B0aW9uc0dhdGhlcmVyPFRWYWx1ZT4gaW1wbGVtZW50cyBPcHRpb25zR2F0aGVyZXI8VFZhbHVlPlxyXG57XHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHJpdmF0ZSBmaWVsZHMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQXJyYXkgb2YgdmlzaWJsZSwgZGlzcGxheWVkIG9wdGlvbnMgZm9yIHNlbGVjdFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9hdmFpbGFibGVPcHRpb25zOiBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+W10gPSBbXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEFycmF5IG9mIHByb3ZpZGVkIG9wdGlvbnMgZm9yIHNlbGVjdFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9vcHRpb25zOiBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+W10gPSBbXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9jY3VycyB3aGVuIGFycmF5IG9mIHZpc2libGUsIGRpc3BsYXllZCBvcHRpb25zIGhhcyBjaGFuZ2VkXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2F2YWlsYWJsZU9wdGlvbnNDaGFuZ2U6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIExpdmUgc2VhcmNoIHBsdWdpbiBjdXJyZW50bHkgdXNlZCBpbiBOZ1NlbGVjdFxyXG4gICAgICovXHJcbiAgICBwcm90ZWN0ZWQgX2xpdmVTZWFyY2g6IExpdmVTZWFyY2g7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJzY3JpcHRpb24gZm9yIGNoYW5nZXMgb2YgbGl2ZSBzZWFyY2ggdmFsdWVcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF9zZWFyY2hWYWx1ZUNoYW5nZVN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgcHJvcGVydGllcyAtIGltcGxlbWVudGF0aW9uIG9mIE9wdGlvbnNHYXRoZXJlciAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcnJheSBvZiBwcm92aWRlZCBvcHRpb25zIGZvciBzZWxlY3RcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldCBvcHRpb25zKHZhbHVlOiBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+W10pXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuX2F2YWlsYWJsZU9wdGlvbnMgPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgb3B0aW9ucygpOiBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+W11cclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE9jY3VycyB3aGVuIGFycmF5IG9mIHByb3ZpZGVkIG9wdGlvbnMgaGFzIGNoYW5nZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIG9wdGlvbnNDaGFuZ2U6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEFycmF5IG9mIHZpc2libGUsIGRpc3BsYXllZCBvcHRpb25zIGZvciBzZWxlY3RcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldCBhdmFpbGFibGVPcHRpb25zKCk6IE5nU2VsZWN0T3B0aW9uPFRWYWx1ZT5bXVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hdmFpbGFibGVPcHRpb25zO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9jY3VycyB3aGVuIGFycmF5IG9mIHZpc2libGUsIGRpc3BsYXllZCBvcHRpb25zIGhhcyBjaGFuZ2VkXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXQgYXZhaWxhYmxlT3B0aW9uc0NoYW5nZSgpOiBFdmVudEVtaXR0ZXI8dm9pZD5cclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYXZhaWxhYmxlT3B0aW9uc0NoYW5nZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE5nU2VsZWN0IHBsdWdpbiBpbnN0YW5jZXMgYXZhaWxhYmxlIGZvciBnYXRoZXJlclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbmdTZWxlY3RQbHVnaW5zOiBOZ1NlbGVjdFBsdWdpbkluc3RhbmNlcztcclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgY29uc3RydWN0b3IgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBfbGl2ZVNlYXJjaEZpbHRlcj86IExpdmVTZWFyY2hGaWx0ZXI8VFZhbHVlPilcclxuICAgIHtcclxuICAgICAgICBpZihpc0JsYW5rKHRoaXMuX2xpdmVTZWFyY2hGaWx0ZXIpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fbGl2ZVNlYXJjaEZpbHRlciA9IChxdWVyeTogc3RyaW5nKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaXRtID0+IGl0bS50ZXh0LmluZGV4T2YocXVlcnkpID49IDA7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBwdWJsaWMgbWV0aG9kcyAtIGltcGxtZW50YXRpb24gb2YgT3B0aW9uc0dhdGhlcmVyICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbiAgICAvKipcclxuICAgICAqIEluaXRpYWxpemUgZ2F0aGVyZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uIHBoYXNlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBpbml0aWFsaXplR2F0aGVyZXIoKTogdm9pZFxyXG4gICAge1xyXG4gICAgICAgIGxldCBsaXZlU2VhcmNoID0gdGhpcy5uZ1NlbGVjdFBsdWdpbnNbTElWRV9TRUFSQ0hdIGFzIExpdmVTZWFyY2g7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuX2xpdmVTZWFyY2ggJiYgdGhpcy5fbGl2ZVNlYXJjaCAhPSBsaXZlU2VhcmNoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fbGl2ZVNlYXJjaCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighdGhpcy5fbGl2ZVNlYXJjaClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX2xpdmVTZWFyY2ggPSBsaXZlU2VhcmNoO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24gPSB0aGlzLl9saXZlU2VhcmNoLnNlYXJjaFZhbHVlQ2hhbmdlLnN1YnNjcmliZSgoKSA9PlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZighdGhpcy5fbGl2ZVNlYXJjaC5zZWFyY2hWYWx1ZSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdmFpbGFibGVPcHRpb25zID0gdGhpcy5vcHRpb25zO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2F2YWlsYWJsZU9wdGlvbnNDaGFuZ2UuZW1pdCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5fYXZhaWxhYmxlT3B0aW9ucyA9IHRoaXMub3B0aW9ucy5maWx0ZXIodGhpcy5fbGl2ZVNlYXJjaEZpbHRlcih0aGlzLl9saXZlU2VhcmNoLnNlYXJjaFZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdmFpbGFibGVPcHRpb25zQ2hhbmdlLmVtaXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbGVkIHdoZW4gZ2F0aGVyZXIgbmVlZHMgdG8gYmUgZGVzdHJveWVkXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkZXN0cm95R2F0aGVyZXIoKTogdm9pZFxyXG4gICAge1xyXG4gICAgICAgIGlmKHRoaXMuX3NlYXJjaFZhbHVlQ2hhbmdlU3Vic2NyaXB0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcclxuICAgICAgICAgICAgdGhpcy5fc2VhcmNoVmFsdWVDaGFuZ2VTdWJzY3JpcHRpb24gPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSJdfQ==