var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ChangeDetectionStrategy, Input, ChangeDetectorRef, ElementRef, Inject, Attribute } from "@angular/core";
import { isString } from '@asseco/common';
import { NgSelectComponent, NG_SELECT_PLUGIN_INSTANCES, ngSelectPluginInstancesFactory, CodeOptionsGatherer } from "@ng/select";
import { Observable } from "rxjs";
/** @type {?} */
var NG_OPTION = "NG-OPTION";
var ɵ0 = ngSelectPluginInstancesFactory;
/**
 * Component that represents WebComponent implementation of NgSelect
 * @template TValue
 */
var NgSelectElementsComponent = /** @class */ (function (_super) {
    __extends(NgSelectElementsComponent, _super);
    //######################### constructors #########################
    function NgSelectElementsComponent(changeDetector, element, pluginInstances, readonly, disabled, multiple) {
        var _this = _super.call(this, changeDetector, element, pluginInstances, null, null, null, null, null, null, null, null, null, readonly, disabled, multiple) || this;
        _this.pluginInstances = pluginInstances;
        /**
         * Options gatherer used for NgSelect WebComponent
         */
        _this._codeOptionsGatherer = new CodeOptionsGatherer();
        //######################### public methods #########################
        /**
         * Initialize component, automatically called once if not blocked by options
         */
        _this.initializeWC = (/**
         * @return {?}
         */
        function () { return _this.initialize(); });
        /**
         * Initialize options, automaticaly called during init phase, but can be used to reinitialize NgSelectOptions
         */
        _this.initOptionsWC = (/**
         * @return {?}
         */
        function () { return _this.initOptions(); });
        /**
         * Gets instance of plugin by its id
         * @param pluginId Id of plugin, use constants
         */
        _this.getPluginWC = (/**
         * @template PluginType
         * @param {?} pluginId
         * @return {?}
         */
        function (pluginId) { return _this.getPlugin(pluginId); });
        /**
         * Explicitly runs invalidation of content (change detection)
         */
        _this.invalidateVisualsWC = (/**
         * @return {?}
         */
        function () { return _this.invalidateVisuals(); });
        /**
         * Executes actions on NgSelect
         * @param actions Array of actions that are executed over NgSelect
         */
        _this.executeWC = (/**
         * @param {...?} actions
         * @return {?}
         */
        function () {
            var actions = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                actions[_i] = arguments[_i];
            }
            return _this.execute.apply(_this, actions);
        });
        /**
         * Executes function on NgSelect and returns result
         * @param func Function that is executed and its result is returned
         */
        _this.executeAndReturnWC = (/**
         * @template TResult
         * @param {?} func
         * @return {?}
         */
        function (func) { return _this.executeAndReturn(func); });
        _this._selectOptions.optionsGatherer = _this._codeOptionsGatherer;
        _this._optionsObserver = new MutationObserver((/**
         * @param {?} mutationsList
         * @return {?}
         */
        function (mutationsList) {
            /** @type {?} */
            var added = false;
            /** @type {?} */
            var removed = false;
            console.log('mutations', mutationsList);
            mutationsList.forEach((/**
             * @param {?} itm
             * @return {?}
             */
            function (itm) {
                itm.addedNodes.forEach((/**
                 * @param {?} node
                 * @return {?}
                 */
                function (node) {
                    if (node.nodeName == NG_OPTION) {
                        added = true;
                    }
                }));
                itm.removedNodes.forEach((/**
                 * @param {?} node
                 * @return {?}
                 */
                function (node) {
                    if (node.nodeName == NG_OPTION) {
                        removed = true;
                    }
                }));
                if (added || removed) {
                    /** @type {?} */
                    var options = [];
                    for (var x = 0; x < element.nativeElement.children.length; x++) {
                        /** @type {?} */
                        var itm_1 = (/** @type {?} */ (element.nativeElement.children.item(x)));
                        if (itm_1.nodeName == NG_OPTION) {
                            options.push(itm_1);
                        }
                    }
                    _this._codeOptionsGatherer.options = options;
                    _this._codeOptionsGatherer.optionsChange.emit();
                    _this._codeOptionsGatherer.availableOptionsChange.emit();
                }
            }));
        }));
        _this._optionsObserver.observe(element.nativeElement, {
            childList: true
        });
        return _this;
    }
    Object.defineProperty(NgSelectElementsComponent.prototype, "initializedWC", {
        //######################### public properties #########################
        /**
         * Occurs every time when NgSelect is initialized or reinitialized, if value is false NgSelect was not initialized yet
         */
        get: 
        //######################### public properties #########################
        /**
         * Occurs every time when NgSelect is initialized or reinitialized, if value is false NgSelect was not initialized yet
         * @return {?}
         */
        function () {
            return this.initialized;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NgSelectElementsComponent.prototype, "isInitializedWC", {
        /**
         * Gets current state of initialization
         */
        get: /**
         * Gets current state of initialization
         * @return {?}
         */
        function () {
            return this.isInitialized;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(NgSelectElementsComponent.prototype, "selectOptionsWC", {
        get: /**
         * @return {?}
         */
        function () {
            return this.selectOptions;
        },
        /**
         * Gets or sets NgSelect options
         */
        set: /**
         * Gets or sets NgSelect options
         * @param {?} options
         * @return {?}
         */
        function (options) {
            if (isString(options)) {
                try {
                    options = JSON.parse(options);
                }
                catch (e) {
                    console.log(e);
                    options = {};
                }
            }
            this.selectOptions = options;
        },
        enumerable: true,
        configurable: true
    });
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     */
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     * @return {?}
     */
    NgSelectElementsComponent.prototype.ngOnDestroy = 
    //######################### public methods - implementation of OnDestroy #########################
    /**
     * Called when component is destroyed
     * @return {?}
     */
    function () {
        if (this._optionsObserver) {
            this._optionsObserver.disconnect();
            this._optionsObserver = null;
        }
        _super.prototype.ngOnDestroy.call(this);
    };
    NgSelectElementsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ng-select-web-component',
                    template: "<ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.textsLocator?.type\" (ngComponentOutletExCreated)=\"setTextsLocatorComponent($event)\"></ng-template>\r\n<ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.liveSearch?.type\" (ngComponentOutletExCreated)=\"setLiveSearchComponent($event)\"></ng-template>\r\n<ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.positioner?.type\" (ngComponentOutletExCreated)=\"setPositionerComponent($event)\"></ng-template>\r\n<ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.keyboardHandler?.type\" (ngComponentOutletExCreated)=\"setKeyboardHandlerComponent($event)\"></ng-template>\r\n<ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.valueHandler?.type\" (ngComponentOutletExCreated)=\"setValueHandlerComponent($event)\"></ng-template>\r\n\r\n<div>\r\n    <ng-template [ngIf]=\"!selectOptions?.readonly\">\r\n        <ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.normalState?.type\" (ngComponentOutletExCreated)=\"setNormalStateComponent($event)\" [ngComponentOutletExContent]=\"liveSearchElement\"></ng-template>\r\n    </ng-template>\r\n\r\n    <ng-template [ngIf]=\"selectOptions?.readonly\">\r\n        <ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.readonlyState?.type\" (ngComponentOutletExCreated)=\"setReadonlyStateComponent($event)\"></ng-template>\r\n    </ng-template>\r\n\r\n    <ng-template [ngComponentOutletEx]=\"selectOptions?.plugins?.popup?.type\" (ngComponentOutletExCreated)=\"setPopupComponent($event)\" [ngComponentOutletExContent]=\"liveSearchElement\"></ng-template>\r\n</div>",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        (/** @type {?} */ ({
                            provide: NG_SELECT_PLUGIN_INSTANCES,
                            useFactory: ɵ0
                        }))
                    ],
                    styles: [":host\n        {\n            display: block;\n            position: relative;\n        }"]
                }] }
    ];
    /** @nocollapse */
    NgSelectElementsComponent.ctorParameters = function () { return [
        { type: ChangeDetectorRef },
        { type: ElementRef },
        { type: undefined, decorators: [{ type: Inject, args: [NG_SELECT_PLUGIN_INSTANCES,] }] },
        { type: String, decorators: [{ type: Attribute, args: ['readonly',] }] },
        { type: String, decorators: [{ type: Attribute, args: ['disabled',] }] },
        { type: String, decorators: [{ type: Attribute, args: ['multiple',] }] }
    ]; };
    NgSelectElementsComponent.propDecorators = {
        initializedWC: [{ type: Input }],
        isInitializedWC: [{ type: Input }],
        selectOptionsWC: [{ type: Input, args: ['selectOptions',] }],
        initializeWC: [{ type: Input }],
        initOptionsWC: [{ type: Input }],
        getPluginWC: [{ type: Input }],
        invalidateVisualsWC: [{ type: Input }],
        executeWC: [{ type: Input }],
        executeAndReturnWC: [{ type: Input }]
    };
    return NgSelectElementsComponent;
}(NgSelectComponent));
export { NgSelectElementsComponent };
if (false) {
    /**
     * Mutation observer, that observes ng-options
     * @type {?}
     * @protected
     */
    NgSelectElementsComponent.prototype._optionsObserver;
    /**
     * Options gatherer used for NgSelect WebComponent
     * @type {?}
     * @protected
     */
    NgSelectElementsComponent.prototype._codeOptionsGatherer;
    /**
     * Initialize component, automatically called once if not blocked by options
     * @type {?}
     */
    NgSelectElementsComponent.prototype.initializeWC;
    /**
     * Initialize options, automaticaly called during init phase, but can be used to reinitialize NgSelectOptions
     * @type {?}
     */
    NgSelectElementsComponent.prototype.initOptionsWC;
    /**
     * Gets instance of plugin by its id
     * \@param pluginId Id of plugin, use constants
     * @type {?}
     */
    NgSelectElementsComponent.prototype.getPluginWC;
    /**
     * Explicitly runs invalidation of content (change detection)
     * @type {?}
     */
    NgSelectElementsComponent.prototype.invalidateVisualsWC;
    /**
     * Executes actions on NgSelect
     * \@param actions Array of actions that are executed over NgSelect
     * @type {?}
     */
    NgSelectElementsComponent.prototype.executeWC;
    /**
     * Executes function on NgSelect and returns result
     * \@param func Function that is executed and its result is returned
     * @type {?}
     */
    NgSelectElementsComponent.prototype.executeAndReturnWC;
    /**
     * @type {?}
     * @protected
     */
    NgSelectElementsComponent.prototype.pluginInstances;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmdTZWxlY3RFbGVtZW50cy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZWxlbWVudHMvY29tcG9uZW50cy9uZ1NlbGVjdEVsZW1lbnRzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsdUJBQXVCLEVBQW1CLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMzSSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEMsT0FBTyxFQUFDLGlCQUFpQixFQUFFLDBCQUEwQixFQUFFLDhCQUE4QixFQUE4RixtQkFBbUIsRUFBaUIsTUFBTSxZQUFZLENBQUM7QUFDMU8sT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLE1BQU0sQ0FBQzs7SUFJMUIsU0FBUyxHQUFHLFdBQVc7U0FlTCw4QkFBOEI7Ozs7O0FBVnREO0lBc0J1RCw2Q0FBeUI7SUE2RDVFLGtFQUFrRTtJQUNsRSxtQ0FBWSxjQUFpQyxFQUNqQyxPQUFnQyxFQUNjLGVBQXdDLEVBQy9ELFFBQWlCLEVBQ2pCLFFBQWlCLEVBQ2pCLFFBQWlCO1FBTHBELFlBT0ksa0JBQU0sY0FBYyxFQUFFLE9BQU8sRUFBRSxlQUFlLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsU0FxRHRJO1FBMUR5RCxxQkFBZSxHQUFmLGVBQWUsQ0FBeUI7Ozs7UUFwRHhGLDBCQUFvQixHQUFnQyxJQUFJLG1CQUFtQixFQUFVLENBQUM7Ozs7O1FBc0l6RixrQkFBWTs7O1FBQUcsY0FBTSxPQUFBLEtBQUksQ0FB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QUFDLDBCQUEwQjs2Q0FDakMsU0FBUyxTQUFDLFVBQVU7NkNBQ3BCLFNBQVMsU0FBQyxVQUFVOzZDQUNwQixTQUFTLFNBQUMsVUFBVTs7O2dDQWhEaEMsS0FBSztrQ0FTTCxLQUFLO2tDQVNMLEtBQUssU0FBQyxlQUFlOytCQTRHckIsS0FBSztnQ0FNTCxLQUFLOzhCQU9MLEtBQUs7c0NBTUwsS0FBSzs0QkFPTCxLQUFLO3FDQU9MLEtBQUs7O0lBRVYsZ0NBQUM7Q0FBQSxBQTFNRCxDQXNCdUQsaUJBQWlCLEdBb0x2RTtTQXBMWSx5QkFBeUI7Ozs7Ozs7SUFPbEMscURBQTZDOzs7Ozs7SUFLN0MseURBQWdHOzs7OztJQXFJaEcsaURBQzhDOzs7OztJQUs5QyxrREFDZ0Q7Ozs7OztJQU1oRCxnREFDbUg7Ozs7O0lBS25ILHdEQUNrRTs7Ozs7O0lBTWxFLDhDQUNzRjs7Ozs7O0lBTXRGLHVEQUN1SDs7Ozs7SUFuSDNHLG9EQUFzRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSwgRmFjdG9yeVByb3ZpZGVyLCBJbnB1dCwgQ2hhbmdlRGV0ZWN0b3JSZWYsIEVsZW1lbnRSZWYsIEluamVjdCwgQXR0cmlidXRlfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge2lzU3RyaW5nfSBmcm9tICdAYXNzZWNvL2NvbW1vbic7XHJcbmltcG9ydCB7TmdTZWxlY3RDb21wb25lbnQsIE5HX1NFTEVDVF9QTFVHSU5fSU5TVEFOQ0VTLCBuZ1NlbGVjdFBsdWdpbkluc3RhbmNlc0ZhY3RvcnksIE5nU2VsZWN0T3B0aW9ucywgTmdTZWxlY3RBY3Rpb24sIE5nU2VsZWN0RnVuY3Rpb24sIE5nU2VsZWN0UGx1Z2luSW5zdGFuY2VzLCBOZ1NlbGVjdFBsdWdpbiwgQ29kZU9wdGlvbnNHYXRoZXJlciwgTmdTZWxlY3RPcHRpb259IGZyb20gXCJAbmcvc2VsZWN0XCI7XHJcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSBcInJ4anNcIjtcclxuXHJcbmltcG9ydCB7TmdTZWxlY3RXZWJDb21wb25lbnR9IGZyb20gXCIuL25nU2VsZWN0RWxlbWVudHMuaW50ZXJmYWNlXCI7XHJcblxyXG5jb25zdCBOR19PUFRJT04gPSBcIk5HLU9QVElPTlwiO1xyXG5cclxuLyoqXHJcbiAqIENvbXBvbmVudCB0aGF0IHJlcHJlc2VudHMgV2ViQ29tcG9uZW50IGltcGxlbWVudGF0aW9uIG9mIE5nU2VsZWN0XHJcbiAqL1xyXG5AQ29tcG9uZW50KFxyXG57XHJcbiAgICBzZWxlY3RvcjogJ25nLXNlbGVjdC13ZWItY29tcG9uZW50JyxcclxuICAgIHRlbXBsYXRlVXJsOiAnbmdTZWxlY3RFbGVtZW50cy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcclxuICAgIHByb3ZpZGVyczpcclxuICAgIFtcclxuICAgICAgICA8RmFjdG9yeVByb3ZpZGVyPlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcHJvdmlkZTogTkdfU0VMRUNUX1BMVUdJTl9JTlNUQU5DRVMsXHJcbiAgICAgICAgICAgIHVzZUZhY3Rvcnk6IG5nU2VsZWN0UGx1Z2luSW5zdGFuY2VzRmFjdG9yeVxyXG4gICAgICAgIH1cclxuICAgIF0sXHJcbiAgICBzdHlsZXM6XHJcbiAgICBbXHJcbiAgICAgICAgYDpob3N0XHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcclxuICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgICAgIH1gXHJcbiAgICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZ1NlbGVjdEVsZW1lbnRzQ29tcG9uZW50PFRWYWx1ZT4gZXh0ZW5kcyBOZ1NlbGVjdENvbXBvbmVudDxUVmFsdWU+IGltcGxlbWVudHMgTmdTZWxlY3RXZWJDb21wb25lbnQ8VFZhbHVlPlxyXG57XHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHJvdGVjdGVkIGZpZWxkcyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNdXRhdGlvbiBvYnNlcnZlciwgdGhhdCBvYnNlcnZlcyBuZy1vcHRpb25zXHJcbiAgICAgKi9cclxuICAgIHByb3RlY3RlZCBfb3B0aW9uc09ic2VydmVyOiBNdXRhdGlvbk9ic2VydmVyO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogT3B0aW9ucyBnYXRoZXJlciB1c2VkIGZvciBOZ1NlbGVjdCBXZWJDb21wb25lbnRcclxuICAgICAqL1xyXG4gICAgcHJvdGVjdGVkIF9jb2RlT3B0aW9uc0dhdGhlcmVyOiBDb2RlT3B0aW9uc0dhdGhlcmVyPFRWYWx1ZT4gPSBuZXcgQ29kZU9wdGlvbnNHYXRoZXJlcjxUVmFsdWU+KCk7XHJcblxyXG4gICAgLy8jIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIHB1YmxpYyBwcm9wZXJ0aWVzICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuXHJcbiAgICAvKipcclxuICAgICAqIE9jY3VycyBldmVyeSB0aW1lIHdoZW4gTmdTZWxlY3QgaXMgaW5pdGlhbGl6ZWQgb3IgcmVpbml0aWFsaXplZCwgaWYgdmFsdWUgaXMgZmFsc2UgTmdTZWxlY3Qgd2FzIG5vdCBpbml0aWFsaXplZCB5ZXRcclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBnZXQgaW5pdGlhbGl6ZWRXQygpOiBPYnNlcnZhYmxlPGJvb2xlYW4+XHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIGN1cnJlbnQgc3RhdGUgb2YgaW5pdGlhbGl6YXRpb25cclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBnZXQgaXNJbml0aWFsaXplZFdDKCk6IGJvb2xlYW5cclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pc0luaXRpYWxpemVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0cyBvciBzZXRzIE5nU2VsZWN0IG9wdGlvbnNcclxuICAgICAqL1xyXG4gICAgQElucHV0KCdzZWxlY3RPcHRpb25zJylcclxuICAgIHB1YmxpYyBzZXQgc2VsZWN0T3B0aW9uc1dDKG9wdGlvbnM6IE5nU2VsZWN0T3B0aW9uczxUVmFsdWU+KVxyXG4gICAge1xyXG4gICAgICAgIGlmKGlzU3RyaW5nKG9wdGlvbnMpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdHJ5XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSBKU09OLnBhcnNlKG9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhdGNoKGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWxlY3RPcHRpb25zID0gb3B0aW9ucztcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXQgc2VsZWN0T3B0aW9uc1dDKCk6IE5nU2VsZWN0T3B0aW9uczxUVmFsdWU+XHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0T3B0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgY29uc3RydWN0b3JzICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyNcclxuICAgIGNvbnN0cnVjdG9yKGNoYW5nZURldGVjdG9yOiBDaGFuZ2VEZXRlY3RvclJlZixcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LFxyXG4gICAgICAgICAgICAgICAgQEluamVjdChOR19TRUxFQ1RfUExVR0lOX0lOU1RBTkNFUykgcHJvdGVjdGVkIHBsdWdpbkluc3RhbmNlczogTmdTZWxlY3RQbHVnaW5JbnN0YW5jZXMsXHJcbiAgICAgICAgICAgICAgICBAQXR0cmlidXRlKCdyZWFkb25seScpIHJlYWRvbmx5Pzogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgQEF0dHJpYnV0ZSgnZGlzYWJsZWQnKSBkaXNhYmxlZD86IHN0cmluZyxcclxuICAgICAgICAgICAgICAgIEBBdHRyaWJ1dGUoJ211bHRpcGxlJykgbXVsdGlwbGU/OiBzdHJpbmcpXHJcbiAgICB7XHJcbiAgICAgICAgc3VwZXIoY2hhbmdlRGV0ZWN0b3IsIGVsZW1lbnQsIHBsdWdpbkluc3RhbmNlcywgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgcmVhZG9ubHksIGRpc2FibGVkLCBtdWx0aXBsZSk7XHJcblxyXG4gICAgICAgIHRoaXMuX3NlbGVjdE9wdGlvbnMub3B0aW9uc0dhdGhlcmVyID0gdGhpcy5fY29kZU9wdGlvbnNHYXRoZXJlcjtcclxuXHJcbiAgICAgICAgdGhpcy5fb3B0aW9uc09ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIobXV0YXRpb25zTGlzdCA9PlxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbGV0IGFkZGVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCByZW1vdmVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtdXRhdGlvbnMnLCBtdXRhdGlvbnNMaXN0KTtcclxuXHJcbiAgICAgICAgICAgIG11dGF0aW9uc0xpc3QuZm9yRWFjaChpdG0gPT4gXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGl0bS5hZGRlZE5vZGVzLmZvckVhY2gobm9kZSA9PlxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKG5vZGUubm9kZU5hbWUgPT0gTkdfT1BUSU9OKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGl0bS5yZW1vdmVkTm9kZXMuZm9yRWFjaChub2RlID0+XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYobm9kZS5ub2RlTmFtZSA9PSBOR19PUFRJT04pXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihhZGRlZCB8fCByZW1vdmVkKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvcHRpb25zOiBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+W10gPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IGVsZW1lbnQubmF0aXZlRWxlbWVudC5jaGlsZHJlbi5sZW5ndGg7IHgrKylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpdG0gPSBlbGVtZW50Lm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW4uaXRlbSh4KSBhcyBOZ1NlbGVjdE9wdGlvbjxUVmFsdWU+ICYgSFRNTEVsZW1lbnQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpdG0ubm9kZU5hbWUgPT0gTkdfT1BUSU9OKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnB1c2goaXRtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29kZU9wdGlvbnNHYXRoZXJlci5vcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb2RlT3B0aW9uc0dhdGhlcmVyLm9wdGlvbnNDaGFuZ2UuZW1pdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvZGVPcHRpb25zR2F0aGVyZXIuYXZhaWxhYmxlT3B0aW9uc0NoYW5nZS5lbWl0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9vcHRpb25zT2JzZXJ2ZXIub2JzZXJ2ZShlbGVtZW50Lm5hdGl2ZUVsZW1lbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZExpc3Q6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIG1ldGhvZHMgLSBpbXBsZW1lbnRhdGlvbiBvZiBPbkRlc3Ryb3kgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB3aGVuIGNvbXBvbmVudCBpcyBkZXN0cm95ZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIG5nT25EZXN0cm95KClcclxuICAgIHtcclxuICAgICAgICBpZih0aGlzLl9vcHRpb25zT2JzZXJ2ZXIpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zT2JzZXJ2ZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3VwZXIubmdPbkRlc3Ryb3koKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgcHVibGljIG1ldGhvZHMgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjI1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBjb21wb25lbnQsIGF1dG9tYXRpY2FsbHkgY2FsbGVkIG9uY2UgaWYgbm90IGJsb2NrZWQgYnkgb3B0aW9uc1xyXG4gICAgICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgcHVibGljIGluaXRpYWxpemVXQyA9ICgpID0+IHRoaXMuaW5pdGlhbGl6ZSgpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZSBvcHRpb25zLCBhdXRvbWF0aWNhbHkgY2FsbGVkIGR1cmluZyBpbml0IHBoYXNlLCBidXQgY2FuIGJlIHVzZWQgdG8gcmVpbml0aWFsaXplIE5nU2VsZWN0T3B0aW9uc1xyXG4gICAgICovXHJcbiAgICBASW5wdXQoKVxyXG4gICAgcHVibGljIGluaXRPcHRpb25zV0MgPSAoKSA9PiB0aGlzLmluaXRPcHRpb25zKCk7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXRzIGluc3RhbmNlIG9mIHBsdWdpbiBieSBpdHMgaWRcclxuICAgICAqIEBwYXJhbSBwbHVnaW5JZCBJZCBvZiBwbHVnaW4sIHVzZSBjb25zdGFudHNcclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBnZXRQbHVnaW5XQyA9IDxQbHVnaW5UeXBlIGV4dGVuZHMgTmdTZWxlY3RQbHVnaW4+KHBsdWdpbklkOiBzdHJpbmcpOiBQbHVnaW5UeXBlID0+IHRoaXMuZ2V0UGx1Z2luKHBsdWdpbklkKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4cGxpY2l0bHkgcnVucyBpbnZhbGlkYXRpb24gb2YgY29udGVudCAoY2hhbmdlIGRldGVjdGlvbilcclxuICAgICAqL1xyXG4gICAgQElucHV0KClcclxuICAgIHB1YmxpYyBpbnZhbGlkYXRlVmlzdWFsc1dDID0gKCk6IHZvaWQgPT4gdGhpcy5pbnZhbGlkYXRlVmlzdWFscygpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXhlY3V0ZXMgYWN0aW9ucyBvbiBOZ1NlbGVjdFxyXG4gICAgICogQHBhcmFtIGFjdGlvbnMgQXJyYXkgb2YgYWN0aW9ucyB0aGF0IGFyZSBleGVjdXRlZCBvdmVyIE5nU2VsZWN0XHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBwdWJsaWMgZXhlY3V0ZVdDID0gKC4uLmFjdGlvbnM6IE5nU2VsZWN0QWN0aW9uPFRWYWx1ZT5bXSkgPT4gdGhpcy5leGVjdXRlKC4uLmFjdGlvbnMpO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXhlY3V0ZXMgZnVuY3Rpb24gb24gTmdTZWxlY3QgYW5kIHJldHVybnMgcmVzdWx0XHJcbiAgICAgKiBAcGFyYW0gZnVuYyBGdW5jdGlvbiB0aGF0IGlzIGV4ZWN1dGVkIGFuZCBpdHMgcmVzdWx0IGlzIHJldHVybmVkXHJcbiAgICAgKi9cclxuICAgIEBJbnB1dCgpXHJcbiAgICBwdWJsaWMgZXhlY3V0ZUFuZFJldHVybldDID0gPFRSZXN1bHQ+KGZ1bmM6IE5nU2VsZWN0RnVuY3Rpb248VFJlc3VsdCwgVFZhbHVlPik6IFRSZXN1bHQgPT4gdGhpcy5leGVjdXRlQW5kUmV0dXJuKGZ1bmMpO1xyXG59Il19